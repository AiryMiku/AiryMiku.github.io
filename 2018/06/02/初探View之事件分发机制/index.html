<!DOCTYPE html>
<html lang="zh">
    <head>
    <!-- 
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.0 -->

    <!-- Title -->
    
    <title>
        
            初探View之事件分发机制 | 
        
        Airy&#39;s Blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#4169E1">
    <meta name="author" content="AiryMiku">
    <meta name="description" content="start from zero">
    <meta name="keywords" content="不学习怎么能变强">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Airy&#39;s Blog">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://airymiku.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="初探View之事件分发机制 | Airy&#39;s Blog">
    <meta property="og:description" content="start from zero">
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #8B008B;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #4169E1 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #4169E1 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #4169E1 !important;
  }

  .toTop {
    background: #4169E1 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #4169E1;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #4169E1;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #4169E1;
  }

  .post-toc a:hover {
    color: #8B008B;
    text-decoration: underline;
  }
</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F0FFFF;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>



    <script src="/js/jquery.min.js"></script>
    <script src="/js/queue.js"></script>

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    

    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Activity"><span class="post-toc-number">2.</span> <span class="post-toc-text">Activity</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Window"><span class="post-toc-number">3.</span> <span class="post-toc-text">Window</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#DecoView-顶级View"><span class="post-toc-number">4.</span> <span class="post-toc-text">DecoView(顶级View)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#View对点击事件的处理"><span class="post-toc-number">5.</span> <span class="post-toc-text">View对点击事件的处理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#尾巴"><span class="post-toc-number">6.</span> <span class="post-toc-text">尾巴</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Pure Thumbnail -->
            <div class="post_thumbnail-pure mdl-card__media mdl-color-text--grey-50" style="background-color:#4169E1 !important">
        
    
            <p class="article-headline-p">
                初探View之事件分发机制
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>AiryMiku</strong>
        <span>6月 02, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=初探View之事件分发机制&url=https://airymiku.github.io//2018/06/02/初探View之事件分发机制/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=初探View之事件分发机制&url=https://airymiku.github.io//2018/06/02/初探View之事件分发机制/index.html&via=AiryMiku" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://airymiku.github.io//2018/06/02/初探View之事件分发机制/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://airymiku.github.io//2018/06/02/初探View之事件分发机制/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>配合<a href="https://blog.csdn.net/xiang_freedom/article/details/54949307" target="_blank" rel="external">Andorid开发艺术探索笔记</a>食用更佳</p>
<p>View的事件分发分一下四部分，每个部分对事件分发的处理是不一样的，从肉眼可见的顺序编写<br>首先上个源码</p>
<p><img src="/img/emmm.jpg" alt="emmm"></p>
<h2 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public boolean dispatchTouchEvent(MotionEvent ev) &#123;</div><div class="line"></div><div class="line">    if (ev.getAction() == MotionEvent.ACTION_DOWN) &#123;</div><div class="line"></div><div class="line">        onUserInteraction();</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (getWindow().superDispatchTouchEvent(ev)) &#123;</div><div class="line"></div><div class="line">        return true;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return onTouchEvent(ev);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>首先是交给附属的Window分发，如果返回了true，整个点击事件循环就结束（分发下去），否则交给Activity的onTouchEvent处理。</p>
<h2 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h2><p>public abstract boolean superDispatchTouchEvent(MotionEvent event);</p>
<p>是一个抽象方法，真正的实现在PhoneWindow</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public boolean superDispatchTouchEvent(MotionEvent event) &#123;</div><div class="line"></div><div class="line">    return mDecor.superDispatchTouchEvent(event);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>事件传给了DecoView，这个就是我们所说的顶级View（也叫ViewRoot），一般是一个ViewGroup</p>
<p>在onCreate中的setContestView就是这个顶级View的一个子View</p>
<h2 id="DecoView-顶级View"><a href="#DecoView-顶级View" class="headerlink" title="DecoView(顶级View)"></a>DecoView(顶级View)</h2><p>伪代码思想</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">funtion dispathTouchEvent(event):</div><div class="line"></div><div class="line">    if (mOnTouchListener) &#123;</div><div class="line">		onTouch(event) </div><div class="line">    &#125; else &#123;</div><div class="line">        if (onInterceptTouchEvent()) &#123;</div><div class="line">            onTouchEvent() - &gt; &#123;</div><div class="line">                if (mOnClickListener) &#123;  // 如果设置了点击监听</div><div class="line">                    onClick()</div><div class="line">                &#125;</div><div class="line">	&#125;  else &#123;</div><div class="line">		superDispathTouchEvent()  // 分发 </div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>源码，ViewGroup的拦截逻辑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">// Check for interception.</div><div class="line"></div><div class="line">final boolean intercepted;</div><div class="line"></div><div class="line">if (actionMasked == MotionEvent.ACTION_DOWN</div><div class="line"></div><div class="line">        || mFirstTouchTarget != null) &#123; // 一旦子元素处理之后，ViewGroup的onInterceptTouchEvent不再处理</div><div class="line"></div><div class="line">    final boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0;</div><div class="line"></div><div class="line">    if (!disallowIntercept) &#123;</div><div class="line"></div><div class="line">        intercepted = onInterceptTouchEvent(ev);</div><div class="line"></div><div class="line">        ev.setAction(action); // restore action in case it was changed</div><div class="line"></div><div class="line">    &#125; else &#123;</div><div class="line"></div><div class="line">        intercepted = false;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125; else &#123;</div><div class="line"></div><div class="line">    // There are no touch targets and this action is not an initial down</div><div class="line"></div><div class="line">    // so this view group continues to intercept touches.</div><div class="line"></div><div class="line">    intercepted = true;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>特别注意的是FLAG_DISALLOW_INTERCEPT这个标记位一旦设置后，ViewGroup无法拦截处理action_down之外的点击事件，</p>
<p>在ViewGroup分发事件的时候action_down会重置这个标记位，所以ViewGroup总是会调用onInterceptTouchEvent来询问是否拦截事件</p>
<p>ViewGroup不拦截的时候，源码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line">final View[] children = mChildren;</div><div class="line"></div><div class="line">for (int i = childrenCount - 1; i &gt;= 0; i--) &#123;</div><div class="line"></div><div class="line">    final int childIndex = getAndVerifyPreorderedIndex(    // 遍历子元素</div><div class="line"></div><div class="line">            childrenCount, i, customOrder);</div><div class="line"></div><div class="line">    final View child = getAndVerifyPreorderedView(</div><div class="line"></div><div class="line">            preorderedList, children, childIndex);</div><div class="line"></div><div class="line">    // If there is a view that has accessibility focus we want it</div><div class="line"></div><div class="line">    // to get the event first and if not handled we will perform a</div><div class="line"></div><div class="line">    // normal dispatch. We may do a double iteration but this is</div><div class="line"></div><div class="line">    // safer given the timeframe.</div><div class="line"></div><div class="line">    if (childWithAccessibilityFocus != null) &#123;     // 动画判断</div><div class="line"></div><div class="line">        if (childWithAccessibilityFocus != child) &#123;</div><div class="line"></div><div class="line">            continue;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        childWithAccessibilityFocus = null;</div><div class="line"></div><div class="line">        i = childrenCount - 1;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (!canViewReceivePointerEvents(child)  //  区域判断</div><div class="line"></div><div class="line">            || !isTransformedTouchPointInView(x, y, child, null)) &#123;</div><div class="line"></div><div class="line">        ev.setTargetAccessibilityFocus(false);</div><div class="line"></div><div class="line">        continue;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    newTouchTarget = getTouchTarget(child);</div><div class="line"></div><div class="line">    if (newTouchTarget != null) &#123;</div><div class="line"></div><div class="line">        // Child is already receiving touch within its bounds.</div><div class="line"></div><div class="line">        // Give it the new pointer in addition to the ones it is handling.</div><div class="line"></div><div class="line">        newTouchTarget.pointerIdBits |= idBitsToAssign;</div><div class="line"></div><div class="line">        break;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    resetCancelNextUpFlag(child);</div><div class="line"></div><div class="line">    if (dispatchTransformedTouchEvent(ev, false, child, idBitsToAssign)) &#123;</div><div class="line"></div><div class="line">        // Child wants to receive touch within its bounds.</div><div class="line"></div><div class="line">        mLastTouchDownTime = ev.getDownTime();</div><div class="line"></div><div class="line">        if (preorderedList != null) &#123;</div><div class="line"></div><div class="line">            // childIndex points into presorted list, find original index</div><div class="line"></div><div class="line">            for (int j = 0; j &lt; childrenCount; j++) &#123;</div><div class="line"></div><div class="line">                if (children[childIndex] == mChildren[j]) &#123;</div><div class="line"></div><div class="line">                    mLastTouchDownIndex = j;</div><div class="line"></div><div class="line">                    break;</div><div class="line"></div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125; else &#123;</div><div class="line"></div><div class="line">            mLastTouchDownIndex = childIndex;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        mLastTouchDownX = ev.getX();</div><div class="line"></div><div class="line">        mLastTouchDownY = ev.getY();</div><div class="line"></div><div class="line">        newTouchTarget = addTouchTarget(child, idBitsToAssign);</div><div class="line"></div><div class="line">        alreadyDispatchedToNewTouchTarget = true;</div><div class="line"></div><div class="line">        break;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>大致逻辑如下：</p>
<p>遍历所有的子元素，判断子元素是否能够接收到点击事件，是否在动画化中和点击事件的坐标是否在子元素的区域内</p>
<p>dispatchTransformedTouchEvent实际上就是调用子元素的dispatchTouchEvent方法</p>
<p>上面的child传递的就不是null，所以事件就交给子元素处理了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if (child == null) &#123;</div><div class="line">    handled = super.dispatchTouchEvent(event);</div><div class="line">&#125; else &#123;</div><div class="line">    handled = child.dispatchTouchEvent(event);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果子元素的dispatchTouchEvent返回true，那么跳出遍历的for循环，mFirstTouchTarget也会被赋值，否则false会继续把事件分发给子元素</p>
<p>addTouchTarget就已经完成了对mFirstTouchTarget的复制，那么ViewGroup就默认拦截同一序列的所有事件</p>
<p>如果遍历的子元素事件没有被合适处理，有两种情况，没有子元素和子元素已经处理了事件，但是dispatchTouchEvent返回了false（子元素在onTouchEvent返回了false）</p>
<p>这就会让ViewGroup自己处理点击事件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// Dispatch to touch targets.</div><div class="line"></div><div class="line">if (mFirstTouchTarget == null) &#123;</div><div class="line"></div><div class="line">    // No touch targets so treat this as an ordinary view.</div><div class="line"></div><div class="line">    handled = dispatchTransformedTouchEvent(ev, canceled, null,</div><div class="line"></div><div class="line">            TouchTarget.ALL_POINTER_IDS);</div></pre></td></tr></table></figure>
<p>第三个child位null，那么通过前的源码就可以知道会调用super.dispatchTouchEvent(event)，这里就会到View的dispathcTouchEvent，事件也就交给了View去完成。</p>
<h2 id="View对点击事件的处理"><a href="#View对点击事件的处理" class="headerlink" title="View对点击事件的处理"></a>View对点击事件的处理</h2><p>源码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public boolean dispatchTouchEvent(MotionEvent event) &#123;</div><div class="line"></div><div class="line">    // If the event should be handled by accessibility focus first.</div><div class="line"></div><div class="line">    if (event.isTargetAccessibilityFocus()) &#123;</div><div class="line"></div><div class="line">        // We don&apos;t have focus or no virtual descendant has it, do not handle the event.</div><div class="line"></div><div class="line">        if (!isAccessibilityFocusedViewOrHost()) &#123;</div><div class="line"></div><div class="line">            return false;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        // We have focus and got the event, then use normal event dispatch.</div><div class="line"></div><div class="line">        event.setTargetAccessibilityFocus(false);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    boolean result = false;</div><div class="line"></div><div class="line">    if (mInputEventConsistencyVerifier != null) &#123;</div><div class="line"></div><div class="line">        mInputEventConsistencyVerifier.onTouchEvent(event, 0);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    final int actionMasked = event.getActionMasked();</div><div class="line"></div><div class="line">    if (actionMasked == MotionEvent.ACTION_DOWN) &#123;</div><div class="line"></div><div class="line">        // Defensive cleanup for new gesture</div><div class="line"></div><div class="line">        stopNestedScroll();</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (onFilterTouchEventForSecurity(event)) &#123;</div><div class="line"></div><div class="line">        if ((mViewFlags &amp; ENABLED_MASK) == ENABLED &amp;&amp; handleScrollBarDragging(event)) &#123;</div><div class="line"></div><div class="line">            result = true;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        //noinspection SimplifiableIfStatement</div><div class="line"></div><div class="line">        ListenerInfo li = mListenerInfo;</div><div class="line"></div><div class="line">        if (li != null &amp;&amp; li.mOnTouchListener != null   // 处理点击事件</div><div class="line"></div><div class="line">                &amp;&amp; (mViewFlags &amp; ENABLED_MASK) == ENABLED</div><div class="line"></div><div class="line">                &amp;&amp; li.mOnTouchListener.onTouch(this, event)) &#123;</div><div class="line"></div><div class="line">            result = true;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (!result &amp;&amp; onTouchEvent(event)) &#123;</div><div class="line"></div><div class="line">            result = true;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (!result &amp;&amp; mInputEventConsistencyVerifier != null) &#123;</div><div class="line"></div><div class="line">        mInputEventConsistencyVerifier.onUnhandledEvent(event, 0);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Clean up after nested scrolls if this is the end of a gesture;</div><div class="line"></div><div class="line">    // also cancel it if we tried an ACTION_DOWN but we didn&apos;t want the rest</div><div class="line"></div><div class="line">    // of the gesture.</div><div class="line"></div><div class="line">    if (actionMasked == MotionEvent.ACTION_UP ||</div><div class="line"></div><div class="line">            actionMasked == MotionEvent.ACTION_CANCEL ||</div><div class="line"></div><div class="line">            (actionMasked == MotionEvent.ACTION_DOWN &amp;&amp; !result)) &#123;</div><div class="line"></div><div class="line">        stopNestedScroll();</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return result;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有点长，但是单看处理点击事件的只有一点，View无法去分发事件，到头了，只能自己去处理事件。</p>
<p>首先，判断是否设置了OnTouchListener，如果Listener的onTouch方法返回true，那么onTouchEvent就不会被调用</p>
<p>证明了Listener的优先级是高于onTouchEvent的，外界处理事件</p>
<p>onTouchEvent部分源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">if ((viewFlags &amp; ENABLED_MASK) == DISABLED) &#123;</div><div class="line"></div><div class="line">    if (action == MotionEvent.ACTION_UP &amp;&amp; (mPrivateFlags &amp; PFLAG_PRESSED) != 0) &#123;</div><div class="line"></div><div class="line">        setPressed(false);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // A disabled view that is clickable still consumes the touch</div><div class="line"></div><div class="line">    // events, it just doesn&apos;t respond to them.</div><div class="line"></div><div class="line">    return (((viewFlags &amp; CLICKABLE) == CLICKABLE</div><div class="line"></div><div class="line">            || (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)</div><div class="line"></div><div class="line">            || (viewFlags &amp; CONTEXT_CLICKABLE) == CONTEXT_CLICKABLE);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果view不可用，照样也会消耗点击事件（源码都tm解释给你听了）</p>
<p>假如view有代理，还会执行TouchDelegate的onTouchEvent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">if (mTouchDelegate != null) &#123;</div><div class="line"></div><div class="line">    if (mTouchDelegate.onTouchEvent(event)) &#123;</div><div class="line"></div><div class="line">        return true;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>具体的点击处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">if (((viewFlags &amp; CLICKABLE) == CLICKABLE ||</div><div class="line"></div><div class="line">        (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE) ||</div><div class="line"></div><div class="line">        (viewFlags &amp; CONTEXT_CLICKABLE) == CONTEXT_CLICKABLE) &#123;</div><div class="line"></div><div class="line">    switch (action) &#123;</div><div class="line"></div><div class="line">        case MotionEvent.ACTION_UP:</div><div class="line"></div><div class="line">            boolean prepressed = (mPrivateFlags &amp; PFLAG_PREPRESSED) != 0;</div><div class="line"></div><div class="line">            if ((mPrivateFlags &amp; PFLAG_PRESSED) != 0 || prepressed) &#123;</div><div class="line"></div><div class="line">                // take focus if we don&apos;t have it already and we should in</div><div class="line"></div><div class="line">                // touch mode.</div><div class="line"></div><div class="line">                boolean focusTaken = false;</div><div class="line"></div><div class="line">                if (isFocusable() &amp;&amp; isFocusableInTouchMode() &amp;&amp; !isFocused()) &#123;</div><div class="line"></div><div class="line">                    focusTaken = requestFocus();</div><div class="line"></div><div class="line">                &#125;</div><div class="line"></div><div class="line">                if (prepressed) &#123;</div><div class="line"></div><div class="line">                    // The button is being released before we actually</div><div class="line"></div><div class="line">                    // showed it as pressed.  Make it show the pressed</div><div class="line"></div><div class="line">                    // state now (before scheduling the click) to ensure</div><div class="line"></div><div class="line">                    // the user sees it.</div><div class="line"></div><div class="line">                    setPressed(true, x, y);</div><div class="line"></div><div class="line">               &#125;</div><div class="line"></div><div class="line">                if (!mHasPerformedLongPress &amp;&amp; !mIgnoreNextUpEvent) &#123;</div><div class="line"></div><div class="line">                    // This is a tap, so remove the longpress check</div><div class="line"></div><div class="line">                    removeLongPressCallback();</div><div class="line"></div><div class="line">                    // Only perform take click actions if we were in the pressed state</div><div class="line"></div><div class="line">                    if (!focusTaken) &#123;</div><div class="line"></div><div class="line">                        // Use a Runnable and post this rather than calling</div><div class="line"></div><div class="line">                        // performClick directly. This lets other visual state</div><div class="line"></div><div class="line">                        // of the view update before click actions start.</div><div class="line"></div><div class="line">                        if (mPerformClick == null) &#123;</div><div class="line"></div><div class="line">                            mPerformClick = new PerformClick();</div><div class="line"></div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                        if (!post(mPerformClick)) &#123;</div><div class="line"></div><div class="line">                            performClick();</div><div class="line"></div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                &#125;</div></pre></td></tr></table></figure>
<p>可以看出只要CLIKABLE和LONG_CLICKABLE有一个是true，他就会消耗事件，onTouchEvent返回true，不管Disable庄涛，然后就是action_up发生出发performClick，</p>
<p>设置Listener之后就会调用onClick方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public boolean performClick() &#123;</div><div class="line"></div><div class="line">    final boolean result;</div><div class="line"></div><div class="line">    final ListenerInfo li = mListenerInfo;</div><div class="line"></div><div class="line">    if (li != null &amp;&amp; li.mOnClickListener != null) &#123;</div><div class="line"></div><div class="line">        playSoundEffect(SoundEffectConstants.CLICK);</div><div class="line"></div><div class="line">        li.mOnClickListener.onClick(this);</div><div class="line"></div><div class="line">        result = true;</div><div class="line"></div><div class="line">    &#125; else &#123;</div><div class="line"></div><div class="line">        result = false;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sendAccessibilityEvent(AccessibilityEvent.TYPE_VIEW_CLICKED);</div><div class="line"></div><div class="line">    return result;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中View的Long Click默认false，ClickAble是由View自己决定的，我们也可自行改变这两个的属性，</p>
<p>分发机制已经梳理得很清晰了。</p>
<h2 id="尾巴"><a href="#尾巴" class="headerlink" title="尾巴"></a>尾巴</h2><p>每次进步一点，积累就会成长不少。一开始我对View是拒绝的，很长很复杂，但是通过自己慢慢厘清源码，配合网上或者书上的一些详解就可以啃下这个骨头。</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    


    <!-- 使用 DISQUS -->
    <div id="disqus-comment">
        <div id="disqus_thread"></div>
<script>
    queue.offer(function() {
            var disqus_config = function () {
                this.page.url = 'https://airymiku.github.io/2018/06/02/初探View之事件分发机制/index.html';  // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };

            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document;
                var s = d.createElement('script');
                s.src = '//null.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        });
</script>

    </div>
    <style>
        #disqus-comment{
            background-color: #eee;
            padding: 2pc;
        }
    </style>



                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/06/06/Activity实现遍历ViewTree/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/05/26/初识内存屏障/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="AiryMiku's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        a532710813@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: a532710813@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/07/">七月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/06/">六月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Dairy/">Dairy<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    
        <li>
            <a href="/gallery" title="Gallery">
                
                    <i class="material-icons sidebar-material-icons">photo</i>
                
                Gallery
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">11</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/profile.php?id=100004418795056" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    
        <a href="https://www.instagram.com/airy_feng/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-instagram.png);">
                <span class="visuallyhidden">Instagram</span>
            </button><!--
     --></a>
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/AiryMiku" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;Airy's Blog
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/lazyload.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#4169E1'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #4169E1, 0 0 15px #4169E1'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#4169E1',
        'border-left-color': '#4169E1'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    <script src="/js/smoothscroll.js"></script>









    <!-- 使用 DISQUS js 代码 -->
    <script id="dsq-count-scr" src="//null.disqus.com/count.js" async></script>



<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
